@using SchoolJournal.ViewModels
@model JournalGridPageViewModel

<table class="table journal-table table-dark">
    <tr>
        <th></th>

        <th colspan="@(Model.Columns.Count-1)">Дата</th>

        <th colspan="3" class="new-column-control-container">
            <i onclick="createColumn()" class="fa fa-plus create-column"></i>
            <i onclick="cancelColumn()" class="fa fa-times cancel-column"></i>
            <i onclick="confirmColumnCreation()" class="fa fa-check confirm-column-creation"></i>
        </th>
    </tr>
    <tr>
        <th>Студент</th>
        @foreach (JournalGridColumnViewModel column in Model.Columns)
        {
            <td>@column.Date.ToString(string.Format("dd/MM/yyyy"))</td>
        }

        <td class="new-column-date">
            <input type="date" class="new-date" id="datetime" />
        </td>

    </tr>
    @foreach (var student in Model.Students)
    {
        <tr>
            <td>@student.FullName</td>

            @foreach (JournalGridColumnViewModel column in Model.Columns)
            {
                int? markValue = column.Marks.FirstOrDefault(x => x.StudentId == student.Id)?.Value;
                <td>
                    @markValue
                </td>
            }

            <td class="new-column-cell">
                <input type="text" class="new-column-input" id="mark-@student.Id" studentid="@student.Id" />
            </td>
        </tr>
    }
        <tr>
            <th></th>
            <th colspan="@(Model.Columns.Count-1)"></th>
            <th colspan="2" class="new-column-control">
                <i onclick="deleteAllColumnsAndDates()" class="fa fa-trash-o delete-all-columns-and-dates"></i>
            </th>
        </tr>
</table>

@Scripts.Render("~/bundles/JournalPageScript")